{% extends "base.html" %}

{% block title %}ویرایش دوره {{ level }}{% endblock %}

{% block content %}
<div class="container d-flex justify-content-center align-items-center" style="min-height: 80vh;">
    <div class="card p-4 shadow-sm" style="max-width: 600px; width: 100%;">
        <h2 class="mb-4 text-center text-primary">✏️ ویرایش دوره {{ level }}</h2>

        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}

        {% if success %}
            <div class="alert alert-success">دوره با موفقیت ویرایش شد ✅</div>
        {% endif %}

        <form method="POST">
            <div class="mb-3">
                <label class="form-label">عنوان:</label>
                <input type="text" name="title" class="form-control" value="{{ course.title }}" required>
            </div>

            <div class="mb-3 position-relative">
                <label for="jalali-datepicker">تاریخ شروع</label>
                <div class="input-group">
                    <input name="start_date_jalali" id="jalali-datepicker" class="form-control" autocomplete="off">
                    <span class="input-group-text"><i class="bi bi-calendar"></i></span>
                </div>
                <input type="hidden" name="start_date" id="gregorian-date">
            </div>

            <div class="mb-3">
                <label class="form-label">مدت (هفته):</label>
                <input type="number" name="duration" class="form-control" value="{{ course.duration_weeks }}" required>
            </div>

            <div class="mb-3">
                <label class="form-label">برنامه زمانی:</label>
                <input type="text" name="schedule" class="form-control" value="{{ course.schedule }}">
            </div>

            <div class="mb-3">
                <label class="form-label">پیش‌نیاز:</label>
                <input type="text" name="prerequisites" class="form-control" value="{{ course.prerequisites }}">
            </div>

            <div class="mb-3">
                <label class="form-label">ظرفیت:</label>
                <input type="number" name="capacity" class="form-control" value="{{ course.capacity }}" required>
            </div>

            <div class="mb-3">
                <label for="teacher" class="form-label">نام استاد:</label>
                <select name="teacher" id="teacher" class="form-select">
                    {% for teacher in teachers %}
                        <option value="{{ teacher }}" {% if course.teacher == teacher %}selected{% endif %}>
                            {{ teacher }}
                        </option>
                    {% endfor %}
                </select>
            </div>


            <div class="text-center mt-4">
                <button type="submit" class="btn btn-primary">💾 ذخیره تغییرات</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- کتابخانه‌های مورد نیاز -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-date/dist/persian-date.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/js/persian-datepicker.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/css/persian-datepicker.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<script>
$(document).ready(function () {
    $("#jalali-datepicker").persianDatepicker({
        format: 'YYYY/MM/DD',
        altField: '#gregorian-date',
        altFormat: 'YYYY/MM/DD',
        observer: true,
        initialValue: false,
        autoClose: true,
        calendar: {
            persian: {
                locale: 'fa'
            }
        }
    });
});
</script>
{% endblock %}
